<!DOCTYPE html>
<html lang="zh-Hant-TW"> 
    <head>
        <title>JaneDe</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"/>
        <link rel="icon" href="https://drive.google.com/uc?export=view&id=1WEuzRi6WTE7exBF5W58xL44L0nlzza31"type="image/x-icon"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://pv.sohu.com/cityjson?ie=utf-8"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>    
    <body>
        <div class="container">
            <div id="c" class="carousel slide" data-ride="carousel"></div>
        </div>
		<div id="head" class="jumbotron text-center">進入JaneDe日記中...</div>
        <div id="main" class="container"></div>
        <a id="gotop" style="display: none;"></a>
        <a id="godown" style="display: inline;"></a>
    </body>
<style type="text/css">		
#gotop {
    position:fixed;
    z-index:90;
    right:30px;
    bottom:31px;
    display:none;
    width:40px;
    height:40px;
    color:#fff;
    background:#FFD78C;
	opacity:0.5;
    line-height:80px;
    border-radius:50%;
    transition:all 0.5s;
    text-align: center;
    box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16), 0 2px 10px 0 rgba(0,0,0,0.12);
}
#gotop :hover{
    background:#0099CC;
}
#godown {
    position:fixed;
    z-index:90;
    right:30px;
    bottom:31px;
    display:none;
    width:40px;
    height:40px;
    color:#fff;
    background:#FFFF8C;
	opacity:0.5;
    line-height:50px;
    border-radius:50%;
    transition:all 0.5s;
    text-align: center;
    box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16), 0 2px 10px 0 rgba(0,0,0,0.12);
}
#godown :hover{
    background:#0099CC;
}
</style>
<script>
function read() {
    var now = new Date();
    $.ajax({
        url: "https://script.google.com/macros/s/AKfycbzAEhu7Ea8-1Z4i8bCQ1URs3lLHrw_FSpfjJLv0Rvc_I8_WSPjGvxjV1pdAlQyFrgMu/exec",
        data: {
            "date": now.toLocaleString(),
            "ip": returnCitySN['cip'],
            "zone": returnCitySN['cname'],
			"lan": navigator.language,
			"device": navigator.userAgent.match().input
        },
        success: function(response) {},
    });
};
function img() {
    $.get('https://script.google.com/macros/s/AKfycbz1o3FTcZsM66Rsps9Lq1_6B2-xpqljYmZitqEcnwLjsJxaa0xPlIGPtLNctZD3DxzM4A/exec', function(data) {
        var r = data.split(",").length;
        var d = data.split(',');
        var c = document.getElementById("c");
        var e = 0;
        var s = "";
        var s2 = "";
        s += '<ol class="carousel-indicators">';
        s2 += '<div class="carousel-inner">';
        for (var i = r - 3; i >= 3; i--) {
            if (i % 3 == 0) {
                if (e == 0) {
                    s += '<li data-target="#c" data-slide-to="0" class="active"></li>';
                    s2 += '<div class="item active">';
                } else {
                    s += '<li data-target="#c" data-slide-to="' + e + '"></li>';
                    s2 += '<div class="item">';
                }
                e++;
                s2 += '<img src="https://drive.google.com/uc?export=view&id=' + d[i - 1] + '" alt="JadeDe" style="width:100%;">';
                s2 += '<div class="carousel-caption">';
                s2 += '<h3>' + d[i - 3] + '</h3>';
                s2 += '<p>' + d[i - 2] + '</p>';
                s2 += '</div>';
                s2 += '</div>';
            }
        }
        s += '</ol>';
        s2 += '</div>';
        s2 += '<a class="left carousel-control" href="#c" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left"></span><span class="sr-only">上一張</span></a>';
        s2 += '<a class="right carousel-control" href="#c" data-slide="next"> <span class="glyphicon glyphicon-chevron-right"></span><span class="sr-only">下一張</span></a>';
        s += s2;
        c.innerHTML = s;
    });
};
$(function() {
    read();
	img();
    $.get('https://script.google.com/macros/s/AKfycbygtCCIVQdG0OGuzZmjqYdLUQpgwnYtYkoB8B4cnqYvtj6SJtiRNzkEJxzMzaRGWWCnlA/exec', function(data) {
        var r = data.split(",").length;
        var d = data.split(',');
        var p = document.getElementById("head");
        var m = document.getElementById("main");
        var s = "";
        var s2 = "";
        s += '<h1>Jane❤De Diary</h1><p>2022/02/14~Forever</p><span>';
        var Today = new Date();
        s += Today.getFullYear() + " 年 " + (Today.getMonth() + 1) + " 月 " + Today.getDate() + " 日";
        var day1 = new Date("06/04/2022");
        var day2 = new Date("02/14/2022");
        var difference = Today.getTime() - day1.getTime();
        var difference2 = Today.getTime() - day2.getTime();
        s += '</span><br><span  style="color:#FF60AF;">';
        s += "相識 " + parseInt(difference2 / (1000 * 60 * 60 * 24)) + " 天";
        s += '</span><span  style="color:#FF60AF;">';
        s += " ❤ 交往 " + parseInt(difference / (1000 * 60 * 60 * 24)) + " 天";
        s += '</span></div>';
        s2 += '<div class="row">';
        for (var i = r - 6; i >= 6; i--) {
            if (i % 6 == 0) {
                s2 += '<div class="col-sm-4">';
                s2 += '<h3>' + d[i - 6] + '</h3>';
                s2 += '<span style="color:green;"> ' + CalculateDateDiff(new Date(d[i - 5])) + ' </span>';
                s2 += '<span style="color:red;"> ' + d[i - 4] + ' </span>';
                s2 += '<span style="color:orange;"> ' + d[i - 3] + ' </span>';
                s2 += '<p>' + d[i - 2].replace(/\n/g, "<br>") + '</p>';
                if (d[i - 1] == "") {
                    s2 += '<span style="color:#FFD4FF;">JaneDe繪圖中</span></div>';
                } else {
                    s2 += '<img src="https://drive.google.com/uc?export=view&id=' + d[i - 1] + '" class="img-responsive" alt="Jane❤De"></div>';
                }
            }
        }
        s2 += '<h style="text-align: center;">© 2022 LU YI DE FOR JANE</h></div>';
        p.innerHTML = s;
        m.innerHTML = s2;
    });
    $(function() {
        $('#gotop').click(function() {
            $('html,body').animate({
                scrollTop: 0
            }, 'slow');
            return false;
        });
        $('#godown').click(function() {
            $('html,body').animate({
                scrollTop: 99999
            }, 'slow');
            return false;
        });
        $(window).scroll(function() {
            if ($(this).scrollTop() > 2500) {
                $('#godown').fadeOut();
                $('#gotop').fadeIn();
            } else if ($(this).scrollTop() == 0) {
                $('#gotop').fadeOut();
                $('#godown').fadeIn();
            }
        });
    });
});
function CalculateDateDiff(recentDate) {
    if (recentDate != "" && !isNaN(Date.parse(recentDate))) {
        var startDate = new Date(recentDate);
        var thisDate = new Date();
        var d = startDate.getDate();
        var day = (d < 10) ? '0' + d : d;
        var m = startDate.getMonth() + 1;
        var month = (m < 10) ? '0' + m : m;
        var yy = startDate.getYear();
        var year = (yy < 1000) ? yy + 1900 : yy;
        var formatDate = year + "-" + month + "-" + day;
        var dateDiff = startDate.dateDiff("y", thisDate);
        var diffUnit = "年";
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("m", thisDate);
            diffUnit = "個月";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("w", thisDate);
            diffUnit = "週";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("d", thisDate);
            diffUnit = "天";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("h", thisDate);
            diffUnit = "小時";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("n", thisDate);
            diffUnit = "分鐘";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("s", thisDate);
            diffUnit = "秒";
        }
        return formatDate + ' 距今 ' + dateDiff + ' ' + diffUnit;
    }
    return "";
}
Date.prototype.dateDiff = function(interval, objDate) {
        if (arguments.length < 2 || objDate.constructor != Date) return undefined;
        switch (interval) {
            case "s":
                return parseInt((objDate - this) / 1000);
            case "n":
                return parseInt((objDate - this) / 60000);
            case "h":
                return parseInt((objDate - this) / 3600000);
            case "d":
                return parseInt((objDate - this) / 86400000);
            case "w":
                return parseInt((objDate - this) / (86400000 * 7));
            case "m":
                return (objDate.getMonth() + 1) + ((objDate.getFullYear() - this.getFullYear()) * 12) - (this.getMonth() + 1);
            case "y":
                return objDate.getFullYear() - this.getFullYear();
            default:
                return undefined;
        }
    } 
</script>