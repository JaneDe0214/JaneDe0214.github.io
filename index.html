<!DOCTYPE html>
<html lang="en"> 
    <head>
        <title>
            JaneDe
        </title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <link rel="icon" href="https://drive.google.com/uc?export=view&id=1WEuzRi6WTE7exBF5W58xL44L0nlzza31"
        type="image/x-icon" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js">
        </script>
        <script src="https://pv.sohu.com/cityjson?ie=utf-8">
        </script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js">
        </script>
    </head>
    
    <body>
        <div class="container">
            <div id="myCarousel" class="carousel slide" data-ride="carousel">
                <!-- Indicators -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="1">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="2">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="3">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="4">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="5">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="6">
                    </li>
                    <li data-target="#myCarousel" data-slide-to="7">
                    </li>
					<li data-target="#myCarousel" data-slide-to="8">
                    </li>
					<li data-target="#myCarousel" data-slide-to="9">
                    </li>
					<li data-target="#myCarousel" data-slide-to="10">
                    </li>
					<li data-target="#myCarousel" data-slide-to="11">
                    </li>
					<li data-target="#myCarousel" data-slide-to="12">
                    </li>
					<li data-target="#myCarousel" data-slide-to="13">
                    </li>
                </ol>
                <div class="carousel-inner">
                    <div class="item active">
                        <img src="https://drive.google.com/uc?export=view&id=1dN6NjieVnSjHBrdOe57MmkzxQVh5Eng_"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                台北101景觀台
                            </h3>
                            <p>
                                2022/07/10 下午 05:45
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1R0yU-8oxDp2bG9TFtDE4ipvpgZ46UBFo"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                台北101景觀台
                            </h3>
                            <p>
                                2022/07/10 下午 05:36
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1YkOaw32pqWoSm853vcxZzFEUcoQdTk93"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                台北101景觀台
                            </h3>
                            <p>
                                2022/07/10 下午 05:36
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1LnaOt5NJy-Sb56jUWYq8fMQjUwpnwWr1"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                台北101景觀台
                            </h3>
                            <p>
                                2022/07/10 下午 05:36
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1JDQqoHldhhH4YReVSImVnb6uEkOE4fqX"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                北市府地下捷運通道
                            </h3>
                            <p>
                                2022/07/10 下午 06:50
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1yRo0MExrGKhhBobKqaqcraQrHwgiNhiW"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                北市府地下捷運通道
                            </h3>
                            <p>
                                2022/07/10 下午 06:51
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=11r4B-E5HujCwA7WSp3Rt14SmDIwyGypy"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:32
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1RIXqkWHNVyGGKqEVwJ-08HWwn8qv5drh"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:33
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1LMCww7BUnEjIx9EATfHbi3T33adcMC59"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:37
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=19mCHrzFw3Pbv1XO0jotYOyvAqtNKZ1g9"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:37
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=11r4B-E5HujCwA7WSp3Rt14SmDIwyGypy"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:32
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=17H2gIIkzDwIRmMPpO2pZ8hnkjha_jEA_"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                首次貞家2人實體麻將
                            </h3>
                            <p>
                                2022/05/22 下午 06:56
                            </p>
                        </div>
                    </div>
                    <div class="item">
                        <img src="https://drive.google.com/uc?export=view&id=1l0NyVquJiT6x56zAoHDSYR_IXcDNF17a"
                        alt="JadeDe" style="width:100%;">
                        <div class="carousel-caption">
                            <h3>
                                聖德宮景觀台
                            </h3>
                            <p>
                                2022/07/03 下午 05:43
                            </p>
                        </div>
                    </div>
                </div>
                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left">
                    </span>
                    <span class="sr-only">
                        Previous
                    </span>
                </a>
                <a class="right carousel-control" href="#myCarousel" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right">
                    </span>
                    <span class="sr-only">
                        Next
                    </span>
                </a>
            </div>
        </div>
        <div id="head" class="jumbotron text-center">
            進入JaneDe日記中...
        </div>
        <div id="main" class="container">
        </div>
        <a id="gotop" style="display: none;">
        </a>
        <a id="godown" style="display: inline;">
        </a>
    </body>

<style type="text/css">		
#gotop {
    position:fixed;
    z-index:90;
    right:30px;
    bottom:31px;
    display:none;
    width:40px;
    height:40px;
    color:#fff;
    background:#FFD78C;
	opacity:0.5;
    line-height:80px;
    border-radius:50%;
    transition:all 0.5s;
    text-align: center;
    box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16), 0 2px 10px 0 rgba(0,0,0,0.12);
}
#gotop :hover{
    background:#0099CC;
}
#godown {
    position:fixed;
    z-index:90;
    right:30px;
    bottom:31px;
    display:none;
    width:40px;
    height:40px;
    color:#fff;
    background:#FFFF8C;
	opacity:0.5;
    line-height:50px;
    border-radius:50%;
    transition:all 0.5s;
    text-align: center;
    box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16), 0 2px 10px 0 rgba(0,0,0,0.12);
}
#godown :hover{
    background:#0099CC;
}
</style>
<script>
function read() {
    var now = new Date();
    $.ajax({
        url: "https://script.google.com/macros/s/AKfycbzAEhu7Ea8-1Z4i8bCQ1URs3lLHrw_FSpfjJLv0Rvc_I8_WSPjGvxjV1pdAlQyFrgMu/exec",
        data: {
            "date": now.toLocaleString(),
            "ip": returnCitySN['cip'],
            "zone": returnCitySN['cname'],
			"lan": navigator.language,
			"device": navigator.userAgent.match().input
        },
        success: function(response) {},
    });
};
$(function() {
    read();
    var $show = $('#show');
    var a = {
        sheetUrl: 'https://docs.google.com/spreadsheets/d/1wf7E8vzzRzByIaHTVLznuh7deQ3r-13xBHzbpEjG0cQ/edit#gid=0',
        sheetTag: '工作表1',
        row: 2,
        col: 1,
        endRow: 999,
        endCol: 999
    };
    $.get('https://script.google.com/macros/s/AKfycbygtCCIVQdG0OGuzZmjqYdLUQpgwnYtYkoB8B4cnqYvtj6SJtiRNzkEJxzMzaRGWWCnlA/exec', a, function(data) {
        var row = data.split(",").length;
        var d = data.split(',');
        var p = document.getElementById("head");
        var m = document.getElementById("main");
        var string = "";
        var string2 = "";
        string += '<h1>Jane❤De Diary</h1><p>2022/02/14~Forever</p><span>';
        var Today = new Date();
        string += Today.getFullYear() + " 年 " + (Today.getMonth() + 1) + " 月 " + Today.getDate() + " 日";
        var day1 = new Date("06/04/2022");
        var day2 = new Date("02/14/2022");
        var difference = Today.getTime() - day1.getTime();
        var difference2 = Today.getTime() - day2.getTime();
        string += '</span><br><span  style="color:#FF60AF;">';
        string += "相識 " + parseInt(difference2 / (1000 * 60 * 60 * 24)) + " 天";
        string += '</span><span  style="color:#FF60AF;">';
        string += " ❤ 交往 " + parseInt(difference / (1000 * 60 * 60 * 24)) + " 天";
        string += '</span></div>';
        string2 += '<div class="row">';
        for (var i = row - 6; i >= 6; i--) {
            if (i % 6 == 0) {
                string2 += '<div class="col-sm-4">';
                string2 += '<h3>' + d[i - 6] + '</h3>';
                string2 += '<span style="color:green;"> ' + CalculateDateDiff(new Date(d[i - 5])) + ' </span>';
                string2 += '<span style="color:red;"> ' + d[i - 4] + ' </span>';
                string2 += '<span style="color:orange;"> ' + d[i - 3] + ' </span>';
                string2 += '<p>' + d[i - 2].replace(/\n/g, "<br>") + '</p>';
                if (d[i - 1] == "") {
                    string2 += '<span style="color:#FFD4FF;">JaneDe繪圖中</span></div>';
                } else {
                    string2 += '<img src="https://drive.google.com/uc?export=view&id=' + d[i - 1] + '" class="img-responsive" alt="Jane❤De"></div>';
                }
            }
        }
        string2 += '<h style="text-align: center;">© 2022 LU YI DE FOR JANE</h></div>';
        p.innerHTML = string;
        m.innerHTML = string2;
    });

    $(function() {
        $('#gotop').click(function() {
            $('html,body').animate({
                scrollTop: 0
            }, 'slow');
            return false;
        });
        $('#godown').click(function() {
            $('html,body').animate({
                scrollTop: 99999
            }, 'slow');
            return false;
        });
        $(window).scroll(function() {
            if ($(this).scrollTop() > 2500) {
                $('#godown').fadeOut();
                $('#gotop').fadeIn();
            } else if ($(this).scrollTop() == 0) {
                $('#gotop').fadeOut();
                $('#godown').fadeIn();
            }
        });
    });
});

function CalculateDateDiff(recentDate) {
    if (recentDate != "" && !isNaN(Date.parse(recentDate))) {
        var startDate = new Date(recentDate);
        var thisDate = new Date();
        var d = startDate.getDate();
        var day = (d < 10) ? '0' + d : d;
        var m = startDate.getMonth() + 1;
        var month = (m < 10) ? '0' + m : m;
        var yy = startDate.getYear();
        var year = (yy < 1000) ? yy + 1900 : yy;
        var formatDate = year + "-" + month + "-" + day;
        var dateDiff = startDate.dateDiff("y", thisDate);
        var diffUnit = "年";
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("m", thisDate);
            diffUnit = "個月";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("w", thisDate);
            diffUnit = "週";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("d", thisDate);
            diffUnit = "天";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("h", thisDate);
            diffUnit = "小時";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("n", thisDate);
            diffUnit = "分鐘";
        }
        if (dateDiff == 0) {
            dateDiff = startDate.dateDiff("s", thisDate);
            diffUnit = "秒";
        }
        return formatDate + ' 距今 ' + dateDiff + ' ' + diffUnit;
    }
    return "等惠貞出現";
}
Date.prototype.dateDiff = function(interval, objDate) {
        if (arguments.length < 2 || objDate.constructor != Date) return undefined;
        switch (interval) {
            case "s":
                return parseInt((objDate - this) / 1000);
            case "n":
                return parseInt((objDate - this) / 60000);
            case "h":
                return parseInt((objDate - this) / 3600000);
            case "d":
                return parseInt((objDate - this) / 86400000);
            case "w":
                return parseInt((objDate - this) / (86400000 * 7));
            case "m":
                return (objDate.getMonth() + 1) + ((objDate.getFullYear() - this.getFullYear()) * 12) - (this.getMonth() + 1);
            case "y":
                return objDate.getFullYear() - this.getFullYear();
            default:
                return undefined;
        }
    } 
</script>